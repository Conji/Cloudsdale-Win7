<Window x:Class="CloudsdaleWin7.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:MVVM="clr-namespace:CloudsdaleWin7.MVVM"
        Title="Cloudsdale" Height="600" Width="800" Icon="Assets/cloudsdale.ico" Closing="SaveSettings">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="568*" />
            <ColumnDefinition Width="64*"/>
            <ColumnDefinition Width="151*"/>
        </Grid.ColumnDefinitions>
        <Frame Name="Frame" Source="/Views\Login.xaml" NavigationUIVisibility="Hidden" Grid.Column="1" 
               MVVM:DisableNavigation.Disable="True" Grid.ColumnSpan="3" Unloaded="Close" />
        <Grid>

            <ListView Name="CloudList" SelectionChanged="CloudListSelectionChanged"
                      Style="{StaticResource ListBoxStyle}" UseLayoutRounding="False" MouseRightButtonDown="KeepCurrentCloud">
                
                <ListView.Background>
                    <SolidColorBrush Color="{DynamicResource PrimaryContent}"/>
                </ListView.Background>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="2" Orientation="Horizontal">
                            <Image Source="{Binding Path=[avatar][mini], Converter={StaticResource StringUriConv}}"
                                   Margin="3" Width="24" Height="24"/>
                            <TextBlock Text="{Binding Path=[name]}" Width="200" FontSize="14" Foreground="White" />
                            <TextBlock x:Name="newCount" Text="" FontSize="12" Foreground="WhiteSmoke" HorizontalAlignment="Right"/>
                            <!--<ContextMenu>
                                <MenuItem Header="Go to cloud"/>
                                <MenuItem Header="Leave this cloud"/>
                                <MenuItem Header="Receive Notifications" IsCheckable="True"/>
                                <Separator/>
                                <MenuItem Header="Cloud details..."/>
                                <MenuItem Header="Cloud rules..."/>
                                <MenuItem Header="Moderator List..."/>
                                <MenuItem Header="Online Users..."/>
                              </ContextMenu>-->
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
        <Border x:Name="MenuPanel" BorderBrush="Black" BorderThickness="1" Grid.Column="3" HorizontalAlignment="Right" Width="80">
            <StackPanel HorizontalAlignment="Right" Width="80" Margin="0,0,-2,-2">
                <StackPanel.Background>
                    <SolidColorBrush Color="{DynamicResource PrimaryBackground}"/>
                </StackPanel.Background>
            </StackPanel>
        </Border>
        <Image HorizontalAlignment="Right" Height="24" VerticalAlignment="Top" Width="20" Source="Assets/Arrows-Left-round-icon.png" MouseDown="ShowMenu" Grid.Column="3"/>
    </Grid>
</Window>